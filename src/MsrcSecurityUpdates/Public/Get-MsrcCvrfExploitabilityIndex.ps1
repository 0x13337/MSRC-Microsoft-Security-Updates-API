
Function Get-MsrcCvrfExploitabilityIndex {
<#
    .SYNOPSIS
        

    .DESCRIPTION

       This function gathers the details for each product identified in a CVRF document.

    .PARAMETER Vulnerability

    .PARAMETER ProductTree
    
    .EXAMPLE
        Get-MsrcCvrfDocument -ID 2016-Nov | Get-MsrcCvrfExploitabilityIndex
   
        Get product details from a CVRF document using the pipeline.
   
    .EXAMPLE
        $cvrfDocument = Get-MsrcCvrfDocument -ID 2016-Nov
        Get-MsrcCvrfExploitabilityIndex -Vulnerability $cvrfDocument.Vulnerability

        Get product details from a CVRF document using a variable and parameters
#>
[CmdletBinding()]
Param (
    [Parameter(Mandatory,ValueFromPipelineByPropertyName)]
    $Vulnerability
    
    # ,
    # 
    # [Parameter(Mandatory,ValueFromPipelineByPropertyName)]
    # $ProductTree
)
Begin {}
Process {
    $Vulnerability | ForEach-Object {
        $v = $_

        $v.Threats | Where { $_.Type -EQ 1 } | ForEach-Object {
            
            $es = Get-MsrcThreatExploitStatus -ExploitStatusString $_.Description.Value
            [PSCustomObject]@{
                CVE = $v.CVE
                Title = $v.Title.Value
                PubliclyDisclosed     = $es.PubliclyDisclosed 
                Exploited             = $es.Exploited
                LatestSoftwareRelease = $es.LatestSoftwareRelease
                OlderSoftwareRelease  = $es.OlderSoftwareRelease
            }
        }
    }
}
End {}
}