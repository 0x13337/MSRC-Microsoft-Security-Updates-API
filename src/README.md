# Sample Code

The sample code serves as an example on how to interact with the API. Currently, the sample code consists of one PowerShell project, however more languages may be provided in the future. In the PowerShell project, you will see three small functions that show how to interact with the API, as well as two larger functions that may facilitate automation and reporting on the most common data needed.

The function `getAffectedProducts` will build an array of PowerShell objects that contain the most commonly used fields, such as affected product name, ID, CVE name, description of the vulnerability, CVSS score information, links to knowledge base articles and downloads, and lastly a list of updates that supersedes the update links given. This function is not all encompassing of the data returned by the API, however other fields are easy to add if needed.

The function `generateReport` serves as an example of how you can build more traditional Microsoft security reports from the data surfaced by the API. This function will build a document, report.html, in the same directory as the PowerShell project. Most of the HTML elements used are put into HTML template variables, which are then filled in with string formatting. This is to allow easy modification of the report output. It is important to note that the example report generated by default simply formats the data given by the API into a HTML document. No data processing or pruning is being done, thus the reports will tend to be long and verbose. It is up to you to decide how to process the data. This is more of an example to show the possibilities of what can be done with the API, and how you may want to use it.
